# Домашнее задание к занятию "6.1. Типы и структура СУБД"



> ## Задача 1
>
> Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определенных данных.
>
> Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:
>
> - Электронные     чеки в json виде
> - Склады     и автомобильные дороги для логистической компании
> - Генеалогические     деревья
> - Кэш     идентификаторов клиентов с ограниченным временем жизни для движка аутентификации
> - Отношения     клиент-покупка для интернет-магазина
>
> Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.



Практическая реализация думаю может отличается от теоретической, будем склоняться к теоретической.

 

**>Электронные чеки в json виде**

По виду БД - думаю подойдут  документо-ориентированные.

СУБД – MongoDB, потому что документы в ней  хранятся в JSON или BSON, а наши документы по условиям задания в JSON.

 

**>Склады и автомобильные дороги для логистической компании**

 

Тут надо понимать логику связей, наверное, тут имеется ввиду цель оптимизация пути, склады и участки дорог от точки А до точки Б.

Тогда теоретически удобны графовые БД - оптимизация пути по суммам стоимости ребер графа (участков дорог).

СУБД, как самую популярную данного типа - Neo4j.

 

 

**>Генеалогические деревья**

**БД** – Сетевая, (не иерархическая, так как нужно отображать 2 родителя, и нельзя хранить их в одной ячейке**).**

**СУБД -** IDS (опять же как самая популярная), на практике думаю использовалась реляционная. 

 

**>Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутентификации**

Подойдет БД – Ключ-значение.

При выборе между СУБД Redis и Memcached выбор в сторону Memcached. 

В обоих данные хранятся в ОЗУ (в Memcached по умолчанию, Redis  как опция).

В Memcached есть настройка времени жизни TTL, все что нужно по условию задачи и более простой\быстрый по сравнению с Redis (не нужен доп. функционал Redis). 

 

**>Отношения клиент-покупка для интернет-магазина**

Теоретически могла бы подойти ключ-значение БД, но при больших заказах будет много избыточных данных, как и в документно-ориентированной. Да и нет контроля по списку продукции. Думаю, много проблем будет по контролю остатков и т.п 

Поэтому  **БД** -Реляционная.

**СУБД** в зависимости от требований в производительности и наличия компетенций сотрудников: 

Oracle\MSSQL, Postgres\MySQL. Если функционал небольшой и согласуется с другими требованиями, то я бы остановился на Postgres как на более масштабируемой в отличии от MySQL.





> ## Задача 2
>
> Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если:
>
> - Данные     записываются на все узлы с задержкой до часа (асинхронная запись)
> - При     сетевых сбоях, система может разделиться на 2 раздельных кластера
> - Система     может не прислать корректный ответ или сбросить соединение
>
> А согласно PACELC-теореме, как бы вы классифицировали данные системы?
>
> 



**>Данные записываются на все узлы с задержкой до часа (асинхронная запись)**

**Cогласно CAP-теореме:** 

Так как запись асинхронная, то узлы в какой-то момент несогласованные.

Так как много узлов то соблюдается доступность, но без гарантии, что ответы всех узлов системы совпадают. => **A**

Если один узел недоступен, то будет обращение к другому узлу => **P**

Поэтому система: **AP**

**Cогласно PACELC-теореме:** 

Так как данные записываются асинхронно, то приоритет доступности, а не консистености.

Поэтому система: **PA/EL**

 

**>При сетевых сбоях, система может разделиться на 2 раздельных кластера**

**Cогласно CAP-теореме:** 

Несогласованная из-за сетевых сбоев.

Кластеризация обеспечивает доступность.

Поэтому: **AP**

**C*огласно PACELC-теореме:**  

Так как кластер отдает приоритет задержке, ломая консистентность (допуская отдельную работу 2 узлов) то ближе к:

**PA/EL**

**>Система может не прислать корректный ответ или сбросить соединение**

**Не соблюдается доступность.** 

**C*огласно CAP-теореме:** 

Не соблюдается доступность: **P/С**

**Cогласно PACELC-теореме:**  

Системе важнее дать быстрый ответ, чем обеспечить консистентность. 

**PC/EL**





> ## Задача 3
>
> Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?
>
> 

Не могут, так как есть принципы противоречат друг другу. BASE отдает приоритет высокой производительности\доступности в ущерб согласованности данных.

**Главное разногласие это в требовании согласованности.**

**ACID** требует **немедленной согласованности**, **BASE** согласованности **в какой то момент времени в будущем,** и согласованность может обеспечиваться не механизмами БД, а средствами разработки.





>## Задача 4
>
> Вам дали задачу написать системное решение, основой которого бы послужили:
>
> - фиксация     некоторых значений с временем жизни
> - реакция     на истечение таймаута
>
> Вы слышали о key-value хранилище, которое поддерживает хранение key-value значений и имеет механизм Pub/Sub. Что это за система? Какие минусы выбора данной системы?

Pub/Sub – система издатель/подписчик.

Узел- издатель имеет список адресов узлов-подписчиков, и по данному списку отправляет, при появлении, данные подписчикам в виде key-value значений (например температуру датчика).

Минусы:

\-     на стороне издателя нужна настройка адресов всех подписчиков и управление ими. 

\-     издатель не контролирует работу подписчика, не знает справляется ли подписчик с получением такого количества сообщений \ успел ли обработать и.

\-     соответственно нет гарантии, что подписчик получил сообщение (нет подтверждения), удаление сообщений на стороне издателя происходит сразу после отправки (то есть, если они потеряны, то нельзя восстановить\отправить повторно, например когда подписчик был недоступен).

\-     нужны дополнительные механизмы проверки доступности издателя, иначе если он публикует важную информацию, например для диагностики сбоя оборудования, то в случае его недоступности мы «сообщение» не получим. 

 