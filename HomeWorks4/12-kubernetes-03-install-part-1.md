# Домашнее задание к занятию "12.3 Развертывание кластера на собственных серверах, лекция 1"
Поработав с персональным кластером, можно заняться проектами. Вам пришла задача подготовить кластер под новый проект.

> ## Задание 1: Описать требования к кластеру
> Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:
>
> * база данных должна быть отказоустойчивой (не менее трех копий, master-slave) и потребляет около 4 ГБ ОЗУ в работе;
> * кэш должен быть аналогично отказоустойчивый, более трех копий, потребление: 4 ГБ ОЗУ, 1 ядро;
> * фронтенд обрабатывает внешние запросы быстро, отдавая статику: не более 50 МБ ОЗУ на каждый экземпляр;
> * бекенду требуется больше: порядка 600 МБ ОЗУ и по 1 ядру на копию.
>
> Требования: опишите, сколько нод в кластере и сколько ресурсов (ядра, ОЗУ, диск) нужно для запуска приложения. Расчет вести из необходимости запуска 5 копий фронтенда и 10 копий бекенда, база и кеш.
>

|             | ЦП, ядро | ОЗУ, ГБ | Кол-во копий                                    | ЦП, ядро (всего) | ОЗУ, ГБ (всего) |
| ----------- | -------- | ------- | ----------------------------------------------- | ---------------- | --------------- |
| 1) БД       | 1        | 4       | >3 (Master=1,  Replica=2)                       | 3                | 12              |
| 2) Кэш      | 1        | 4       | >4, оптимально выбрать 6 (Master=3,  Replica=3) | 6                | 24              |
| 3) Фронтенд |          | 0.05    | 5                                               |                  | 0.25            |
| 4) Бекенд   | 1        | 0.6     | 10                                              | 10               | 6               |



|                                  | **ЦП, ядро** | **ОЗУ, ГБ**   |
| -------------------------------- | ------------ | ------------- |
| **Требования для Control Plane** | от 2 ядра    | ОЗУ — от 2 ГБ |
| **Требования для рабочей ноды**  | от 1 ядра    | ОЗУ — от 1 ГБ |



I) БД.  Нужно разместить на отдельные ноды, чтобы исключить влияние других подсистем.

1-3 ноды) 3 отдельные рабочие ноды.  

ЦП = 1 (БД) + 1 (Треб.Раб.Нода) +1 запас = 3 ядра.

ОЗУ =  4  (БД) + 1 (Треб.Раб.Нода) +1 запас = 6 Гб

II) Так как бэкендов больше всего - 10 шт, то можно было разделить подсистемы на 10 нод,  но так как требования к бэкенду низкие, то это затратно.

Поэтому я выбрал 6нод по числу Кеш-серверов.

4-8 ноды)  

ЦП = 1(Кеш) + 1(Треб.Раб.Нода) +1 (запас\Фронтенд) + 2 Бэкенд = 5 ядер.

ОЗУ = 4(Кеш) + 1(Треб.Раб.Нода) + 2 (запас\Фронтенд\ 2 Бэкенд) = 7 Гб.

9) На данную ноду могут переехать 2-3 Бэкенда

ЦП = 1(Кеш) + 1(Треб.Раб.Нода) +3 (запас)   = 5 ядер.

ОЗУ = 4(Кеш) + 1(Треб.Раб.Нода) + 2 (запас) = 7 Гб.

10-12) 3 Control Plane 

ЦП = 2 ядра.

ОЗУ =  2 Гб

Итого требуется:

| Вид узла                  | ЦП, ядро | ОЗУ, ГБ | Кол-во копий, шт |
| ------------------------- | -------- | ------- | ---------------- |
| Control Plane             | 2        | 2       | 3                |
| Worker node (База данный) | 3        | 6       | 3                |
| Worker node (Остальные)   | 5        | 7       | 6                |





